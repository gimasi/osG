<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>osG: Jump Start</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">osG
   &#160;<span id="projectnumber">0.2.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Jump Start </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#section_ide">IDE</a></li>
<li class="level1"><a href="#section_setup_keil">Keil Setup</a></li>
<li class="level1"><a href="#section_blinking_led_sourcecode">The Blinking Led example sourcecode</a><ul><li class="level2"><a href="#section_blinking_led_c">Blinking Led code</a></li>
<li class="level2"><a href="#section_osgconfig_h">osgConfig.h example</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>A short guide to perform environment setup </p>
<h1><a class="anchor" id="section_ide"></a>
IDE</h1>
<p>At the moment, the prefered IDE is Keil uVision, version 5 or newer, which runs under Windows. The remainder of this document is a tutorial by using the "Blinking Led" example.</p>
<h1><a class="anchor" id="section_setup_keil"></a>
Keil Setup</h1>
<p>To begin the creation of a project, the simplest way is to start from an existing example, as instance, from the "Blinking Led" test, inside the "tests/blinking_led" directory. To open the project, double click on the project solution file (Led.uvprojx). </p><div class="image">
<img src="project_solution.png" alt="project_solution.png"/>
</div>
  If required, let Keil to install required packages. </p><div class="image">
<img src="install_missing_packages.png" alt="install_missing_packages.png"/>
</div>
  Additional packages or upgdating einstalled ones can be performed by using the "Pack Installer" utility. </p><div class="image">
<img src="update_packages.png" alt="update_packages.png"/>
</div>
  Please note that users can use the osG library only with supported BSP's and boards. Porting to other targets can be considered by osG developers.</p>
<h1><a class="anchor" id="section_blinking_led_sourcecode"></a>
The Blinking Led example sourcecode</h1>
<p>In the "Blinking Led" example, there are only two files of importance for osG users:</p><ul>
<li>blinking_led.c: the example sourcecode</li>
<li>osgConfig.h: the configuration file for the osG library</li>
</ul>
<p>Both files are explained in the following subsections.</p>
<h2><a class="anchor" id="section_blinking_led_c"></a>
Blinking Led code</h2>
<p>The "Blinking Led" code is here explained. First of all, configuration fiels, standard headers, and the library headers are included. </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;osgConfig.h&quot;</span></div><div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;osg-all-in-one.h&gt;</span></div></div><!-- fragment --><p> Please note that there are two options to include the osG library:</p><ul>
<li>The first chance is by using osg-all-in-one.h: this header file is related to the osg-all-in-one.c file. Basically, this includes all the required osG sources into a single file, therefore, users must include/compile in their projects only the osg-all-in-one.c file. This way of using osG has been designed as a convenience for users, and it is the preferred way.</li>
<li>The other chance is to include "osg.h". This inclusion requires users to manually add all the osG ".c" implementation files to their project soution. Since this leads to no actual advantage, it is not recommanded.</li>
</ul>
<p>After the inclusions, follows the implementation of the application user code. It can usually contain:</p><ul>
<li>Initialization of devices</li>
<li>Setup of threads (in case of operative system usage)</li>
<li>The actual application logic</li>
</ul>
<p>In this simple example, only leds are initialized, after which the actual application logic follows. Please note that the appliccation method entry point must be a method taking no arguments and returning "void". </p><div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> applicationUserCode(<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <a class="code" href="structosg__Led.html">osg_Led</a> green;</div><div class="line">    <a class="code" href="structosg__Led.html">osg_Led</a> blue;</div><div class="line">    <a class="code" href="structosg__Led.html">osg_Led</a> red;</div><div class="line">    <a class="code" href="structosg__LedConfig.html">osg_LedConfig</a> ledConfig;</div><div class="line">    memset(&amp;ledConfig, 0, <span class="keyword">sizeof</span>(ledConfig));</div><div class="line"></div><div class="line">    ledConfig.<a class="code" href="structosg__LedConfig.html#a7bb32ad83edfad681451a2fae43d9fb6">ledId</a> = OSG_LED_GREEN;</div><div class="line">    <a class="code" href="group__Led.html#ga278ed95f2986f39437529bf2e87d56ad">osg_Led_ctor</a>(&amp;green, &amp;ledConfig);</div><div class="line">    ...</div><div class="line">    <span class="keywordflow">for</span> (;;) { <span class="comment">/* ntd */</span> }</div><div class="line">}</div></div><!-- fragment --><p> As quite usual, at the end the application method does not returns but goes into an infinite loop.</p>
<p>Finally, the main is implemented. It is used for two purposes:</p><ul>
<li>The base HW initialization</li>
<li>Specify which is the application entry point. This is the method passed as argument to the HW initialization routine, and in this example, it is the previously declared "applicationUserCode()" method. <div class="fragment"><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <span class="keyword">const</span> Bool res = <a class="code" href="group__Base.html#ga842e32487319fff6a89b98912285fb36">osg_baseHw_start</a>(applicationUserCode);</div><div class="line">    <a class="code" href="group__Log.html#ga676f5da2e9cc1fa9a1a84662b7d0a33c">osg_assert</a>(res == TRUE, <span class="stringliteral">&quot;HW base initialization failed&quot;</span>);</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> It is "osg_baseHw_start()" responsability to invoke the "applicationUserCode()" method. Please note that the only chance to execute code after the "osg_baseHw_start()" invokation is that the HW initialization fails, or after the completion of the application execution, therefore, no actual useful code should be placed there.</li>
</ul>
<h2><a class="anchor" id="section_osgconfig_h"></a>
osgConfig.h example</h2>
<p>The "osgConfig.h" is the file used to configure the osG library. More specifically, it configures:</p><ul>
<li>The board for which the user project is going to be compiled</li>
<li>The devices that are used by the project</li>
<li>The used operative system (optional)</li>
</ul>
<p>The structure of the file is as follows. First of all, the board configuration is performed. THis section is standard, and the user should never change it. </p><div class="fragment"><div class="line"><span class="comment">/// @name Board configuration</span></div><div class="line"><span class="comment"></span><span class="comment">/// This section lists the available boards and boards familites.</span></div><div class="line"><span class="comment"></span><span class="comment">/// Set the BOARD_FAMILY adn BOARD_NAME macro as preferred.</span></div><div class="line"><span class="comment"></span><span class="comment">/// @{</span></div><div class="line"><span class="comment"></span><span class="preprocessor">#define STM_BOARD    0</span></div><div class="line"><span class="preprocessor">#define NXP_BOARD    1</span></div><div class="line"><span class="preprocessor">#define STM32_L4     0</span></div><div class="line"><span class="preprocessor">#define NXP_MK28F    1</span></div><div class="line"><span class="preprocessor">#if defined(STM32L476xx)</span></div><div class="line"><span class="preprocessor">#define BOARD_FAMILY STM_BOARD</span></div><div class="line"><span class="preprocessor">#define BOARD_NAME   STM32_L4</span></div><div class="line"><span class="preprocessor">#elif defined(CPU_MK28FN2M0VMI15)</span></div><div class="line"><span class="preprocessor">#define BOARD_FAMILY NXP_BOARD</span></div><div class="line"><span class="preprocessor">#define BOARD_NAME   NXP_MK28F</span></div><div class="line"><span class="preprocessor">#else</span></div><div class="line"><span class="preprocessor">#define BOARD_FAMILY &quot;UNKNOWN&quot;</span></div><div class="line"><span class="preprocessor">#define BOARD_NAME   &quot;UNKNOWN&quot;</span></div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"><span class="preprocessor">/// @}</span></div></div><!-- fragment --><p> The initial macros are a sort of "enum": they list in unique values:</p><ul>
<li>The board family (STM_BOARD, NXP_BOARD)</li>
<li>The specific board name (STM32_L4, NXP_MK28F)</li>
</ul>
<p>After which, some standard lines of code follows. These lines configure the BOARD_FAMILY and BOARD_NAME macros, by automatically checking macros provided by specific boards BSP's. Users can use these declared macros to write board-specific code in their applications. For example: </p><div class="fragment"><div class="line"><span class="preprocessor">#if BOARD_NAME == STM32_L4</span></div><div class="line"><span class="comment">// STM32 L4 specific code here</span></div><div class="line"><span class="preprocessor">#elif BOARD_FAMILY == NXP_BOARD</span></div><div class="line"><span class="comment">// Code for all NXP boards here</span></div><div class="line"><span class="preprocessor">#endif</span></div></div><!-- fragment --><p>"osgConfig.h" file continues with the selection of drivers for required devices. Please note that only the optional devices are listed. As instance, GPIO and LED are mandatory, and therefore their are automatically included. </p><div class="fragment"><div class="line"><span class="comment">/// @name Driver features</span></div><div class="line"><span class="comment"></span><span class="comment">/// Each macro can hold:</span></div><div class="line"><span class="comment"></span><span class="comment">/// - 1 to enable the feature</span></div><div class="line"><span class="comment"></span><span class="comment">/// - 0 to disable it</span></div><div class="line"><span class="comment"></span><span class="comment">/// @{</span></div><div class="line"><span class="comment"></span><span class="preprocessor">#define OSG_USE_I2C    1</span></div><div class="line"><span class="preprocessor">#define OSG_USE_SPI    1</span></div><div class="line"><span class="preprocessor">#define OSG_USE_TIMER  1</span></div><div class="line"><span class="preprocessor">#define OSG_USE_UART   1</span></div><div class="line"><span class="preprocessor">/// @}</span></div></div><!-- fragment --><p> In this example, all the drivers are included, even if the "Blinking Led" does not use them.</p>
<p>The usage of the optional operative system is stated by the following configuration code. </p><div class="fragment"><div class="line"><span class="comment">/// @name OS Names</span></div><div class="line"><span class="comment"></span><span class="comment">/// List of available OS &quot;names&quot;.</span></div><div class="line"><span class="comment"></span><span class="comment">/// Set the OSG_OS_NAME to the name of the preferred one</span></div><div class="line"><span class="comment"></span><span class="comment">/// @{</span></div><div class="line"><span class="comment"></span><span class="preprocessor">#define OSG_OS_NONE        0</span></div><div class="line"><span class="preprocessor">#define OSG_OS_CMSIS_RTOS2 1</span></div><div class="line"><span class="preprocessor">#define OSG_OS_NAME        OSG_OS_NONE</span></div><div class="line"><span class="preprocessor">/// @}</span></div></div><!-- fragment --><p> First of all, there is another "enum", listing all the available operative systems. At the moment, the possible choises are "no operative system" (OSG_OS_NONE), and CMSIS RTOS v2 (OSG_OS_CMSIS_RTOS2). Users can edit the OSG_OS_NAME macro value to specify the preferred operative system. In the "Blinking Led" example, no operative system is used.</p>
<p>In case of the usage of an operative system, the last section of the configuration file must be edited, setting to 1 the features of interest. </p><div class="fragment"><div class="line"><span class="comment">/// @name OS features</span></div><div class="line"><span class="comment"></span><span class="comment">/// Each macro can hold:</span></div><div class="line"><span class="comment"></span><span class="comment">/// - 1 to enable the feature</span></div><div class="line"><span class="comment"></span><span class="comment">/// - 0 to disable it</span></div><div class="line"><span class="comment"></span><span class="comment">/// Note: OSG_OS_USE_TIMERS is usually set to the</span></div><div class="line"><span class="comment"></span><span class="comment">/// same value of OSG_USE_TIMERS</span></div><div class="line"><span class="comment"></span><span class="comment">/// @{</span></div><div class="line"><span class="comment"></span><span class="preprocessor">#define OSG_OS_USE_THREAD 1</span></div><div class="line"><span class="preprocessor">#define OSG_OS_USE_TIMER  OSG_USE_TIMER</span></div><div class="line"><span class="preprocessor">/// @}</span></div></div><!-- fragment --><p> Please note that the OSG_OS_USE_TIMER should never be edited: prefer to edit OSG_USE_TIMER to specify when timers must be included. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
